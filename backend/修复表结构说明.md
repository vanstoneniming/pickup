# 修复数据库表结构

## 问题描述

错误信息：`Unknown column 'avatar' in 'field list'`

原因：数据库表结构和模型定义不一致，User 模型中定义了 `avatar` 和 `last_login_at` 字段，但数据库表中缺少这些字段。

## 解决方案

### 方法一：执行 SQL 脚本修复（推荐）

```bash
cd backend
mysql -u root -p pickup_db < fix-users-table.sql
```

### 方法二：手动执行 SQL

登录 MySQL：

```bash
mysql -u root -p pickup_db
```

然后执行：

```sql
-- 添加 avatar 字段
ALTER TABLE users 
ADD COLUMN avatar VARCHAR(255) COMMENT '头像URL' AFTER real_name;

-- 添加 last_login_at 字段
ALTER TABLE users 
ADD COLUMN last_login_at DATETIME COMMENT '最后登录时间' AFTER status;

-- 验证
DESCRIBE users;
```

### 方法三：重新创建表（会丢失数据）

如果表中没有重要数据，可以删除并重新创建：

```bash
mysql -u root -p pickup_db < init-database.sql
```

## 验证修复

修复后，重启后端服务，应该不再出现字段错误。

## 完整的 users 表结构

修复后，users 表应该包含以下字段：
- id
- username
- password
- role
- phone
- email
- real_name
- avatar ✅（需要添加）
- status
- last_login_at ✅（需要添加）
- created_at
- updated_at

